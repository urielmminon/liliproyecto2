{"paragraphs":[{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1557806534091_146099570","id":"20190514-040214_986404960","dateCreated":"2019-05-14T04:02:14+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:261","text":"%pyspark\nimport pyspark \nfrom pyspark.sql.session import SparkSession\nfrom pyspark.sql.types import *\nfrom pyspark.sql.functions import *  \nfrom pyspark.ml.feature import OneHotEncoder, StringIndexer, SQLTransformer, Normalizer, VectorAssembler, VectorIndexer\nfrom pyspark.ml import Pipeline\nfrom pyspark.ml.linalg import Vectors\nfrom pyspark.ml.regression import RandomForestRegressor,LinearRegression\nfrom pyspark.ml.evaluation import RegressionEvaluator\nfrom pyspark.ml.tuning import ParamGridBuilder, TrainValidationSplit","dateUpdated":"2019-05-14T05:16:25+0000","dateFinished":"2019-05-14T05:16:25+0000","dateStarted":"2019-05-14T05:16:25+0000","results":{"code":"SUCCESS","msg":[]}},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1557806544588_1713628291","id":"20190514-040224_500839217","dateCreated":"2019-05-14T04:02:24+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:338","text":"%pyspark\nprofecoSchema = StructType([StructField(\"producto\", StringType(), True), \\\n                     StructField(\"presentacion\", StringType(), True), \\\n                     StructField(\"marca\", StringType(), True), \\\n                     StructField(\"categoria\", StringType(), True), \\\n                     StructField(\"catalogo\", StringType(), True), \\\n                     StructField(\"precio\", DoubleType(), True), \\\n                     StructField(\"fecharegistro\", TimestampType(), True), \\\n                     StructField(\"cadenacomercial\", StringType(), True), \\\n                     StructField(\"giro\", StringType(), True), \\\n                     StructField(\"nombrecomercial\", StringType(), True), \\\n                     StructField(\"direccion\", StringType(), True), \\\n                     StructField(\"estado\", StringType(), True), \\\n                     StructField(\"municipio\", StringType(), True), \\\n                     StructField(\"latitud\", DoubleType(), True), \\\n                     StructField(\"longitud\", DoubleType(), True)] )","dateUpdated":"2019-05-14T04:06:13+0000","dateFinished":"2019-05-14T04:06:13+0000","dateStarted":"2019-05-14T04:06:13+0000","results":{"code":"SUCCESS","msg":[]}},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1557806597161_676950875","id":"20190514-040317_120228217","dateCreated":"2019-05-14T04:03:17+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:879","text":"%pyspark\nprofecoDf = spark.read.format(\"csv\")\\\n        .option(\"delimiter\", \"|\")\\\n        .option(\"header\",\"true\")\\\n        .schema(profecoSchema) \\\n        .load(\"s3://luispuente/profeco_final_bash.csv\")","dateUpdated":"2019-05-14T04:09:08+0000","dateFinished":"2019-05-14T04:09:11+0000","dateStarted":"2019-05-14T04:09:08+0000","results":{"code":"SUCCESS","msg":[]}},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1557806843837_1959836802","id":"20190514-040723_1115802547","dateCreated":"2019-05-14T04:07:23+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1031","text":"%pyspark\nprofecoDf.printSchema()","dateUpdated":"2019-05-14T04:09:54+0000","dateFinished":"2019-05-14T04:09:54+0000","dateStarted":"2019-05-14T04:09:54+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- producto: string (nullable = true)\n |-- presentacion: string (nullable = true)\n |-- marca: string (nullable = true)\n |-- categoria: string (nullable = true)\n |-- catalogo: string (nullable = true)\n |-- precio: double (nullable = true)\n |-- fecharegistro: timestamp (nullable = true)\n |-- cadenacomercial: string (nullable = true)\n |-- giro: string (nullable = true)\n |-- nombrecomercial: string (nullable = true)\n |-- direccion: string (nullable = true)\n |-- estado: string (nullable = true)\n |-- municipio: string (nullable = true)\n |-- latitud: double (nullable = true)\n |-- longitud: double (nullable = true)\n\n"}]}},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1557806845003_268070841","id":"20190514-040725_2105818146","dateCreated":"2019-05-14T04:07:25+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1103","text":"%pyspark\n# Manipulación de variables\nsqlTrans = SQLTransformer( \\\n    statement=\"SELECT * FROM  __THIS__ \\\n          WHERE categoria LIKE '%medicamentos%' \\\n          AND estado='distrito federal' \\\n          AND MONTH(fecharegistro)=4 \\\n          AND YEAR(fecharegistro)=2016\")","dateUpdated":"2019-05-14T04:11:58+0000","dateFinished":"2019-05-14T04:11:58+0000","dateStarted":"2019-05-14T04:11:58+0000","results":{"code":"SUCCESS","msg":[]}},{"text":"%pyspark\n# Selección de variables\nformula = SQLTransformer( \\\n#    statement=\"SELECT producto, marca, precio AS label ,cadenacomercial, municipio FROM  __THIS__ GROUP BY producto\")\n    statement=\"SELECT producto,marca,cadenacomercial, municipio, MEAN(precio) AS label FROM  __THIS__ GROUP BY producto,marca,cadenacomercial,municipio\")","user":"anonymous","dateUpdated":"2019-05-14T04:13:12+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1557807189798_-1781781149","id":"20190514-041309_1350826074","dateCreated":"2019-05-14T04:13:09+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1608","dateFinished":"2019-05-14T04:13:12+0000","dateStarted":"2019-05-14T04:13:12+0000","results":{"code":"SUCCESS","msg":[]}},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1557806845870_-1991322719","id":"20190514-040725_339970275","dateCreated":"2019-05-14T04:07:25+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1175","text":"%pyspark\n# Formato de String a categótico\nproductoIndexer = StringIndexer(inputCol=\"producto\", outputCol=\"productoIndex\")\nmarcaIndexer = StringIndexer(inputCol=\"marca\", outputCol=\"marcaIndex\")\ncadenacomercialIndexer = StringIndexer(inputCol=\"cadenacomercial\", outputCol=\"cadenacomercialIndex\")\nmunicipioIndexer = StringIndexer(inputCol=\"municipio\", outputCol=\"municipioIndex\")","dateUpdated":"2019-05-14T04:13:14+0000","dateFinished":"2019-05-14T04:13:14+0000","dateStarted":"2019-05-14T04:13:14+0000","results":{"code":"SUCCESS","msg":[]}},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1557807134424_-758296849","id":"20190514-041214_1584485461","dateCreated":"2019-05-14T04:12:14+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1288","text":"%pyspark\nassembler = VectorAssembler(\n    inputCols=[\"productoIndex\", \"marcaIndex\",\"cadenacomercialIndex\",\"municipioIndex\"],\n    outputCol=\"Features\")","dateUpdated":"2019-05-14T04:13:17+0000","dateFinished":"2019-05-14T04:13:18+0000","dateStarted":"2019-05-14T04:13:18+0000","results":{"code":"SUCCESS","msg":[]}},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1557807135848_-931211447","id":"20190514-041215_1857442661","dateCreated":"2019-05-14T04:12:15+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1360","text":"%pyspark\n# Train a random forest model\nrf = RandomForestRegressor(labelCol='label',featuresCol='Features',maxBins=400)\npipeline = Pipeline(stages=[sqlTrans,formula,productoIndexer,marcaIndexer,cadenacomercialIndexer,municipioIndexer,assembler,rf])","dateUpdated":"2019-05-14T04:13:20+0000","dateFinished":"2019-05-14T04:13:20+0000","dateStarted":"2019-05-14T04:13:20+0000","results":{"code":"SUCCESS","msg":[]}},{"text":"%pyspark\nparamGrid = ParamGridBuilder()\\\n    .addGrid(rf.maxDepth, [2,5,7])\\\n    .addGrid(rf.numTrees, [64,96,128])\\\n    .build()","user":"anonymous","dateUpdated":"2019-05-14T04:13:33+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1557807211519_-1100662649","id":"20190514-041331_395077127","dateCreated":"2019-05-14T04:13:31+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1680","dateFinished":"2019-05-14T04:13:33+0000","dateStarted":"2019-05-14T04:13:33+0000","results":{"code":"SUCCESS","msg":[]}},{"text":"%pyspark\ntvs = TrainValidationSplit(estimator=pipeline,\n                           estimatorParamMaps=paramGrid,\n                           evaluator=RegressionEvaluator(),\n                           # 80% of the data will be used for training, 20% for validation.\n                           trainRatio=0.8)","user":"anonymous","dateUpdated":"2019-05-14T04:13:41+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1557807215424_-823018321","id":"20190514-041335_1128039720","dateCreated":"2019-05-14T04:13:35+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1752","dateFinished":"2019-05-14T04:13:41+0000","dateStarted":"2019-05-14T04:13:41+0000","results":{"code":"SUCCESS","msg":[]}},{"text":"%pyspark\nmodel = tvs.fit(profecoDf)","user":"anonymous","dateUpdated":"2019-05-14T04:13:55+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1557807223645_966518725","id":"20190514-041343_1086999652","dateCreated":"2019-05-14T04:13:43+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1824","dateFinished":"2019-05-14T05:14:44+0000","dateStarted":"2019-05-14T04:13:55+0000","results":{"code":"SUCCESS","msg":[]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=0","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=1","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=2","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=3","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=4","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=5","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=7","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=8","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=9","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=10","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=11","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=12","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=13","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=14","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=15","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=16","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=18","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=19","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=20","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=21","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=22","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=23","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=24","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=25","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=26","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=27","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=28","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=29","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=30","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=32","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=33","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=34","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=35","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=36","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=37","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=38","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=39","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=40","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=41","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=42","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=43","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=44","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=45","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=46","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=48","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=49","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=50","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=51","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=52","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=53","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=54","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=55","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=56","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=57","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=59","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=60","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=61","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=62","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=63","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=64","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=65","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=66","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=67","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=68","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=69","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=70","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=71","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=73","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=74","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=75","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=76","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=77","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=78","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=79","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=80","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=81","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=82","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=83","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=84","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=85","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=86","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=87","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=89","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=90","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=91","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=92","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=93","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=94","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=95","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=96","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=97","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=98","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=100","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=101","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=102","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=103","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=104","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=105","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=106","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=107","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=108","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=109","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=110","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=111","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=112","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=114","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=115","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=116","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=117","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=118","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=119","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=120","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=121","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=122","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=123","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=124","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=125","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=126","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=127","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=128","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=130","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=131","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=132","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=133","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=134","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=135","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=136","http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=137"],"interpreterSettingId":"spark"}}},{"text":"%pyspark\nmodel.estimator","user":"anonymous","dateUpdated":"2019-05-14T05:13:12+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1557810790869_449326704","id":"20190514-051310_1719793218","dateCreated":"2019-05-14T05:13:10+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2128","dateFinished":"2019-05-14T05:14:44+0000","dateStarted":"2019-05-14T05:13:12+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Param(parent=u'TrainValidationSplitModel_799a177ee4de', name='estimator', doc='estimator to be cross-validated')\n"}]}},{"text":"%pyspark\nmodel.bestModel","user":"anonymous","dateUpdated":"2019-05-14T05:13:38+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1557810816688_164640209","id":"20190514-051336_1646786051","dateCreated":"2019-05-14T05:13:36+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2276","dateFinished":"2019-05-14T05:14:44+0000","dateStarted":"2019-05-14T05:14:44+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"PipelineModel_9405428c74f6\n"}]}},{"text":"%pyspark\nmodel.uid","user":"anonymous","dateUpdated":"2019-05-14T05:13:27+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1557810806026_-764953380","id":"20190514-051326_1642132477","dateCreated":"2019-05-14T05:13:26+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2200","dateFinished":"2019-05-14T05:14:44+0000","dateStarted":"2019-05-14T05:14:44+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"u'TrainValidationSplitModel_799a177ee4de'\n"}]}},{"text":"%pyspark\nmodel.explainParams()","user":"anonymous","dateUpdated":"2019-05-14T05:13:52+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1557810831472_-1832791239","id":"20190514-051351_2023136625","dateCreated":"2019-05-14T05:13:51+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2354","dateFinished":"2019-05-14T05:14:45+0000","dateStarted":"2019-05-14T05:14:45+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"u\"estimator: estimator to be cross-validated (current: Pipeline_4375c40d5a1f)\\nestimatorParamMaps: estimator param maps (current: [{Param(parent=u'RandomForestRegressor_69908099fd06', name='numTrees', doc='Number of trees to train (>= 1).'): 64, Param(parent=u'RandomForestRegressor_69908099fd06', name='maxDepth', doc='Maximum depth of the tree. (>= 0) E.g., depth 0 means 1 leaf node; depth 1 means 1 internal node + 2 leaf nodes.'): 2}, {Param(parent=u'RandomForestRegressor_69908099fd06', name='numTrees', doc='Number of trees to train (>= 1).'): 64, Param(parent=u'RandomForestRegressor_69908099fd06', name='maxDepth', doc='Maximum depth of the tree. (>= 0) E.g., depth 0 means 1 leaf node; depth 1 means 1 internal node + 2 leaf nodes.'): 5}, {Param(parent=u'RandomForestRegressor_69908099fd06', name='numTrees', doc='Number of trees to train (>= 1).'): 64, Param(parent=u'RandomForestRegressor_69908099fd06', name='maxDepth', doc='Maximum depth of the tree. (>= 0) E.g., depth 0 means 1 leaf node; depth 1 means 1 internal node + 2 leaf nodes.'): 7}, {Param(parent=u'RandomForestRegressor_69908099fd06', name='numTrees', doc='Number of trees to train (>= 1).'): 96, Param(parent=u'RandomForestRegressor_69908099fd06', name='maxDepth', doc='Maximum depth of the tree. (>= 0) E.g., depth 0 means 1 leaf node; depth 1 means 1 internal node + 2 leaf nodes.'): 2}, {Param(parent=u'RandomForestRegressor_69908099fd06', name='numTrees', doc='Number of trees to train (>= 1).'): 96, Param(parent=u'RandomForestRegressor_69908099fd06', name='maxDepth', doc='Maximum depth of the tree. (>= 0) E.g., depth 0 means 1 leaf node; depth 1 means 1 internal node + 2 leaf nodes.'): 5}, {Param(parent=u'RandomForestRegressor_69908099fd06', name='numTrees', doc='Number of trees to train (>= 1).'): 96, Param(parent=u'RandomForestRegressor_69908099fd06', name='maxDepth', doc='Maximum depth of the tree. (>= 0) E.g., depth 0 means 1 leaf node; depth 1 means 1 internal node + 2 leaf nodes.'): 7}, {Param(parent=u'RandomForestRegressor_69908099fd06', name='numTrees', doc='Number of trees to train (>= 1).'): 128, Param(parent=u'RandomForestRegressor_69908099fd06', name='maxDepth', doc='Maximum depth of the tree. (>= 0) E.g., depth 0 means 1 leaf node; depth 1 means 1 internal node + 2 leaf nodes.'): 2}, {Param(parent=u'RandomForestRegressor_69908099fd06', name='numTrees', doc='Number of trees to train (>= 1).'): 128, Param(parent=u'RandomForestRegressor_69908099fd06', name='maxDepth', doc='Maximum depth of the tree. (>= 0) E.g., depth 0 means 1 leaf node; depth 1 means 1 internal node + 2 leaf nodes.'): 5}, {Param(parent=u'RandomForestRegressor_69908099fd06', name='numTrees', doc='Number of trees to train (>= 1).'): 128, Param(parent=u'RandomForestRegressor_69908099fd06', name='maxDepth', doc='Maximum depth of the tree. (>= 0) E.g., depth 0 means 1 leaf node; depth 1 means 1 internal node + 2 leaf nodes.'): 7}])\\nevaluator: evaluator used to select hyper-parameters that maximize the validator metric (current: RegressionEvaluator_70d8d7fc0b18)\\nseed: random seed. (default: -5331951213106942295)\"\n"}]}},{"text":"%pyspark\nmodel.extractParamMap()","user":"anonymous","dateUpdated":"2019-05-14T05:14:04+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1557810842428_-89072268","id":"20190514-051402_1204388904","dateCreated":"2019-05-14T05:14:02+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2428","dateFinished":"2019-05-14T05:14:45+0000","dateStarted":"2019-05-14T05:14:45+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"{Param(parent=u'TrainValidationSplitModel_799a177ee4de', name='estimator', doc='estimator to be cross-validated'): Pipeline_4375c40d5a1f, Param(parent=u'TrainValidationSplitModel_799a177ee4de', name='evaluator', doc='evaluator used to select hyper-parameters that maximize the validator metric'): RegressionEvaluator_70d8d7fc0b18, Param(parent=u'TrainValidationSplitModel_799a177ee4de', name='seed', doc='random seed.'): -5331951213106942295, Param(parent=u'TrainValidationSplitModel_799a177ee4de', name='estimatorParamMaps', doc='estimator param maps'): [{Param(parent=u'RandomForestRegressor_69908099fd06', name='numTrees', doc='Number of trees to train (>= 1).'): 64, Param(parent=u'RandomForestRegressor_69908099fd06', name='maxDepth', doc='Maximum depth of the tree. (>= 0) E.g., depth 0 means 1 leaf node; depth 1 means 1 internal node + 2 leaf nodes.'): 2}, {Param(parent=u'RandomForestRegressor_69908099fd06', name='numTrees', doc='Number of trees to train (>= 1).'): 64, Param(parent=u'RandomForestRegressor_69908099fd06', name='maxDepth', doc='Maximum depth of the tree. (>= 0) E.g., depth 0 means 1 leaf node; depth 1 means 1 internal node + 2 leaf nodes.'): 5}, {Param(parent=u'RandomForestRegressor_69908099fd06', name='numTrees', doc='Number of trees to train (>= 1).'): 64, Param(parent=u'RandomForestRegressor_69908099fd06', name='maxDepth', doc='Maximum depth of the tree. (>= 0) E.g., depth 0 means 1 leaf node; depth 1 means 1 internal node + 2 leaf nodes.'): 7}, {Param(parent=u'RandomForestRegressor_69908099fd06', name='numTrees', doc='Number of trees to train (>= 1).'): 96, Param(parent=u'RandomForestRegressor_69908099fd06', name='maxDepth', doc='Maximum depth of the tree. (>= 0) E.g., depth 0 means 1 leaf node; depth 1 means 1 internal node + 2 leaf nodes.'): 2}, {Param(parent=u'RandomForestRegressor_69908099fd06', name='numTrees', doc='Number of trees to train (>= 1).'): 96, Param(parent=u'RandomForestRegressor_69908099fd06', name='maxDepth', doc='Maximum depth of the tree. (>= 0) E.g., depth 0 means 1 leaf node; depth 1 means 1 internal node + 2 leaf nodes.'): 5}, {Param(parent=u'RandomForestRegressor_69908099fd06', name='numTrees', doc='Number of trees to train (>= 1).'): 96, Param(parent=u'RandomForestRegressor_69908099fd06', name='maxDepth', doc='Maximum depth of the tree. (>= 0) E.g., depth 0 means 1 leaf node; depth 1 means 1 internal node + 2 leaf nodes.'): 7}, {Param(parent=u'RandomForestRegressor_69908099fd06', name='numTrees', doc='Number of trees to train (>= 1).'): 128, Param(parent=u'RandomForestRegressor_69908099fd06', name='maxDepth', doc='Maximum depth of the tree. (>= 0) E.g., depth 0 means 1 leaf node; depth 1 means 1 internal node + 2 leaf nodes.'): 2}, {Param(parent=u'RandomForestRegressor_69908099fd06', name='numTrees', doc='Number of trees to train (>= 1).'): 128, Param(parent=u'RandomForestRegressor_69908099fd06', name='maxDepth', doc='Maximum depth of the tree. (>= 0) E.g., depth 0 means 1 leaf node; depth 1 means 1 internal node + 2 leaf nodes.'): 5}, {Param(parent=u'RandomForestRegressor_69908099fd06', name='numTrees', doc='Number of trees to train (>= 1).'): 128, Param(parent=u'RandomForestRegressor_69908099fd06', name='maxDepth', doc='Maximum depth of the tree. (>= 0) E.g., depth 0 means 1 leaf node; depth 1 means 1 internal node + 2 leaf nodes.'): 7}]}\n"}]}},{"text":"%pyspark\nmodel.getEstimatorParamMaps()","user":"anonymous","dateUpdated":"2019-05-14T05:14:20+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1557810857348_-1573371010","id":"20190514-051417_1137000614","dateCreated":"2019-05-14T05:14:17+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2502","dateFinished":"2019-05-14T05:14:45+0000","dateStarted":"2019-05-14T05:14:45+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[{Param(parent=u'RandomForestRegressor_69908099fd06', name='numTrees', doc='Number of trees to train (>= 1).'): 64, Param(parent=u'RandomForestRegressor_69908099fd06', name='maxDepth', doc='Maximum depth of the tree. (>= 0) E.g., depth 0 means 1 leaf node; depth 1 means 1 internal node + 2 leaf nodes.'): 2}, {Param(parent=u'RandomForestRegressor_69908099fd06', name='numTrees', doc='Number of trees to train (>= 1).'): 64, Param(parent=u'RandomForestRegressor_69908099fd06', name='maxDepth', doc='Maximum depth of the tree. (>= 0) E.g., depth 0 means 1 leaf node; depth 1 means 1 internal node + 2 leaf nodes.'): 5}, {Param(parent=u'RandomForestRegressor_69908099fd06', name='numTrees', doc='Number of trees to train (>= 1).'): 64, Param(parent=u'RandomForestRegressor_69908099fd06', name='maxDepth', doc='Maximum depth of the tree. (>= 0) E.g., depth 0 means 1 leaf node; depth 1 means 1 internal node + 2 leaf nodes.'): 7}, {Param(parent=u'RandomForestRegressor_69908099fd06', name='numTrees', doc='Number of trees to train (>= 1).'): 96, Param(parent=u'RandomForestRegressor_69908099fd06', name='maxDepth', doc='Maximum depth of the tree. (>= 0) E.g., depth 0 means 1 leaf node; depth 1 means 1 internal node + 2 leaf nodes.'): 2}, {Param(parent=u'RandomForestRegressor_69908099fd06', name='numTrees', doc='Number of trees to train (>= 1).'): 96, Param(parent=u'RandomForestRegressor_69908099fd06', name='maxDepth', doc='Maximum depth of the tree. (>= 0) E.g., depth 0 means 1 leaf node; depth 1 means 1 internal node + 2 leaf nodes.'): 5}, {Param(parent=u'RandomForestRegressor_69908099fd06', name='numTrees', doc='Number of trees to train (>= 1).'): 96, Param(parent=u'RandomForestRegressor_69908099fd06', name='maxDepth', doc='Maximum depth of the tree. (>= 0) E.g., depth 0 means 1 leaf node; depth 1 means 1 internal node + 2 leaf nodes.'): 7}, {Param(parent=u'RandomForestRegressor_69908099fd06', name='numTrees', doc='Number of trees to train (>= 1).'): 128, Param(parent=u'RandomForestRegressor_69908099fd06', name='maxDepth', doc='Maximum depth of the tree. (>= 0) E.g., depth 0 means 1 leaf node; depth 1 means 1 internal node + 2 leaf nodes.'): 2}, {Param(parent=u'RandomForestRegressor_69908099fd06', name='numTrees', doc='Number of trees to train (>= 1).'): 128, Param(parent=u'RandomForestRegressor_69908099fd06', name='maxDepth', doc='Maximum depth of the tree. (>= 0) E.g., depth 0 means 1 leaf node; depth 1 means 1 internal node + 2 leaf nodes.'): 5}, {Param(parent=u'RandomForestRegressor_69908099fd06', name='numTrees', doc='Number of trees to train (>= 1).'): 128, Param(parent=u'RandomForestRegressor_69908099fd06', name='maxDepth', doc='Maximum depth of the tree. (>= 0) E.g., depth 0 means 1 leaf node; depth 1 means 1 internal node + 2 leaf nodes.'): 7}]\n"}]}},{"text":"%pyspark\nmodel.validationMetrics","user":"anonymous","dateUpdated":"2019-05-14T05:14:30+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1557810868059_-1252287486","id":"20190514-051428_490195768","dateCreated":"2019-05-14T05:14:28+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2576","dateFinished":"2019-05-14T05:14:45+0000","dateStarted":"2019-05-14T05:14:45+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[210.7910652045569, 118.91544956871294, 106.88803432655752, 208.20172716044553, 120.0461599519326, 106.10540723819824, 206.61721754377413, 119.50859796491216, 106.43124213094137]\n"}]}},{"text":"%pyspark\nprediction = model.transform(profecoDf)","user":"anonymous","dateUpdated":"2019-05-14T05:15:07+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1557810884567_1671110813","id":"20190514-051444_1729981747","dateCreated":"2019-05-14T05:14:44+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2648","dateFinished":"2019-05-14T05:15:07+0000","dateStarted":"2019-05-14T05:15:07+0000","results":{"code":"SUCCESS","msg":[]}},{"text":"%pyspark\na = prediction.select('producto','Features','label','prediction').limit(20)","user":"anonymous","dateUpdated":"2019-05-14T05:16:48+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1557810915441_1199926209","id":"20190514-051515_1757774981","dateCreated":"2019-05-14T05:15:15+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2884","dateFinished":"2019-05-14T05:16:48+0000","dateStarted":"2019-05-14T05:16:48+0000","results":{"code":"SUCCESS","msg":[]}},{"text":"%pyspark\nz.show(a)","user":"anonymous","dateUpdated":"2019-05-14T05:16:59+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1557811012058_-898472948","id":"20190514-051652_1495318150","dateCreated":"2019-05-14T05:16:52+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3004","dateFinished":"2019-05-14T05:23:07+0000","dateStarted":"2019-05-14T05:16:59+0000","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"producto\tFeatures\tlabel\tprediction\npiascledine 300\t[79.0,0.0,8.0,6.0]\t351.8\t361.3550677019745\nnovotiral\t[113.0,0.0,5.0,3.0]\t262.95\t295.7387695318514\ntafirol flex\t[99.0,0.0,5.0,3.0]\t368.9\t386.76345944687864\nneo melubrina\t[167.0,0.0,3.0,3.0]\t56.9375\t81.21572944267085\nnootropil\t[118.0,0.0,3.0,3.0]\t462.0\t415.19255802475396\npiascledine 300\t[79.0,0.0,15.0,0.0]\t329.1\t341.09639817747086\nmicardis plus\t[25.0,0.0,0.0,1.0]\t643.0\t687.0302984845398\npulmonarom\t[93.0,0.0,2.0,8.0]\t482.0\t445.5059376585128\npantoprazol\t[231.0,0.0,2.0,8.0]\t149.0\t136.4709969357715\nrinelon\t[147.0,0.0,17.0,0.0]\t644.5\t655.9359548240197\nnootropil\t[118.0,0.0,1.0,0.0]\t445.0\t417.7046902790994\nsedalmerck\t[201.0,0.0,3.0,8.0]\t53.75\t67.41682591754967\nsirdalud\t[36.0,0.0,3.0,8.0]\t324.5\t300.1032837449321\nlexapro\t[103.0,0.0,3.0,0.0]\t1239.6666666666667\t1153.6152956805697\nseloken zok\t[110.0,0.0,3.0,0.0]\t233.0\t253.44612641620168\nrefresh tears\t[210.0,0.0,1.0,7.0]\t483.0\t457.57767202112944\nmaterna\t[196.0,0.0,12.0,2.0]\t208.01\t177.34925540062707\nmucosolvan\t[34.0,0.0,4.0,7.0]\t116.26666666666667\t112.10616378829972\nzintrepid\t[92.0,0.0,4.0,6.0]\t1004.6600000000001\t967.1327847825934\nhalcion\t[225.0,0.0,7.0,1.0]\t851.0\t841.1358444982479\n"},{"type":"TEXT","data":"\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-47-52.us-west-2.compute.internal:4040/jobs/job?id=138"],"interpreterSettingId":"spark"}}},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1557807138303_177412833","id":"20190514-041218_234522306","dateCreated":"2019-05-14T04:12:18+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1504"}],"name":"SparkPipeline","id":"2EBAQMBK1","noteParams":{},"noteForms":{},"angularObjects":{"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}